# TODO: install new ppa for getting latest php stuff

# TODO: install 5.4

- name: install php5-dev
  apt: pkg=php5-dev
  notify:
    - restart php5-fpm

- name: add php.ini files
  copy: src=common/files/php.${item}.ini dest=/etc/php5/${item}/php.ini
  with_items:
    - cli
    - fpm
    - apache2
  ignore_errors: true # because apache and/or php-fpm may or may not be installed on the target machine
  
- name: install PHP xmlrpc module
  apt: pkg=php5-xmlrpc
  notify:
    - restart php5-fpm

- name: install APC
  apt: pkg=php-apc
  notify:
    - restart php5-fpm

- name: install PHP mysql driver
  apt: pkg=php5-mysql
  notify:
    - restart php5-fpm

- name: install PHP mongo driver
  apt: pkg=php5-mongo
  notify:
    - restart php5-fpm

- name: install PHP curl library
  apt: pkg=php5-curl
  notify:
    - restart php5-curl

- name: set up configuration symlink for PHP mongo driver
  file: src=/etc/php5/mods-available/mongo.ini
        dest=/etc/php5/conf.d/mongo.ini
        state=link

- name: install php5-cli
  apt: pkg=php5-cli

- name: install composer
  shell: curl -s http://getcomposer.org/installer | php -- --install-dir=/usr/local/bin
         creates=/usr/local/bin/composer.phar
